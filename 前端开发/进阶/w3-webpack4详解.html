<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>w3-webpack4è¯¦è§£ | Jason&#39;s Blog</title>
    <meta name="description" content="Jasonä¸ªäººç«™ï¼ŒæŠ€æœ¯ï¼Œè¥é”€å’Œç™½æ—¥æ¢¦ ga">
    <link rel="icon" href="/favicon.icon">
    
    <link rel="preload" href="/assets/css/0.styles.79ba9eaa.css" as="style"><link rel="preload" href="/assets/js/app.20b7a3cd.js" as="script"><link rel="preload" href="/assets/js/2.94e36c74.js" as="script"><link rel="preload" href="/assets/js/3.ff294584.js" as="script"><link rel="prefetch" href="/assets/js/10.1d27e27a.js"><link rel="prefetch" href="/assets/js/11.e4f2875f.js"><link rel="prefetch" href="/assets/js/12.b35cc923.js"><link rel="prefetch" href="/assets/js/13.f07507f2.js"><link rel="prefetch" href="/assets/js/14.458caf1e.js"><link rel="prefetch" href="/assets/js/15.a99294e4.js"><link rel="prefetch" href="/assets/js/16.7cb0eb3c.js"><link rel="prefetch" href="/assets/js/17.c3e00627.js"><link rel="prefetch" href="/assets/js/18.03c2d240.js"><link rel="prefetch" href="/assets/js/19.9c92a692.js"><link rel="prefetch" href="/assets/js/20.ad8acc7f.js"><link rel="prefetch" href="/assets/js/21.0446ff0b.js"><link rel="prefetch" href="/assets/js/22.a4ba6dc2.js"><link rel="prefetch" href="/assets/js/23.10931822.js"><link rel="prefetch" href="/assets/js/24.29db39b4.js"><link rel="prefetch" href="/assets/js/25.4265a2b1.js"><link rel="prefetch" href="/assets/js/26.ad124b4a.js"><link rel="prefetch" href="/assets/js/27.29dfdf21.js"><link rel="prefetch" href="/assets/js/28.98b3e125.js"><link rel="prefetch" href="/assets/js/29.52a42b6a.js"><link rel="prefetch" href="/assets/js/30.9700a75f.js"><link rel="prefetch" href="/assets/js/31.67960775.js"><link rel="prefetch" href="/assets/js/4.2c04eda2.js"><link rel="prefetch" href="/assets/js/5.57c93f9b.js"><link rel="prefetch" href="/assets/js/6.7b8561e6.js"><link rel="prefetch" href="/assets/js/7.74e24fbc.js"><link rel="prefetch" href="/assets/js/8.8e068b73.js"><link rel="prefetch" href="/assets/js/9.aa96a151.js">
    <link rel="stylesheet" href="/assets/css/0.styles.79ba9eaa.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Jason's Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/å‰ç«¯å¼€å‘/" class="nav-link">å‰ç«¯</a></div><div class="nav-item"><a href="/ç®—æ³•/" class="nav-link">ç®—æ³•</a></div><div class="nav-item"><a href="/å¢é•¿é»‘å®¢/" class="nav-link">å¢é•¿é»‘å®¢</a></div><div class="nav-item"><a href="/æ•…äº‹/" class="nav-link">æ•…äº‹</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/å‰ç«¯å¼€å‘/" class="nav-link">å‰ç«¯</a></div><div class="nav-item"><a href="/ç®—æ³•/" class="nav-link">ç®—æ³•</a></div><div class="nav-item"><a href="/å¢é•¿é»‘å®¢/" class="nav-link">å¢é•¿é»‘å®¢</a></div><div class="nav-item"><a href="/æ•…äº‹/" class="nav-link">æ•…äº‹</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>åŸºç¡€</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/å‰ç«¯å¼€å‘/åŸºç¡€/js-Javascripté«˜çº§ç¨‹åºè®¾è®¡ç¬”è®°.html" class="sidebar-link">js--JavaScripté«˜çº§ç¨‹åºè®¾è®¡</a></li><li><a href="/å‰ç«¯å¼€å‘/åŸºç¡€/js-å¸¸è§æºç å®ç°.html" class="sidebar-link">js--å¸¸è§æºç å®ç°</a></li><li><a href="/å‰ç«¯å¼€å‘/åŸºç¡€/js-ç»§æ‰¿ä¸åŸå‹é“¾.html" class="sidebar-link">js-ä½œç”¨åŸŸï¼ŒåŸå‹é“¾ï¼Œé—­åŒ…</a></li><li><a href="/å‰ç«¯å¼€å‘/åŸºç¡€/css-cssåŸºç¡€.html" class="sidebar-link">css--css åŸºç¡€</a></li><li><a href="/å‰ç«¯å¼€å‘/åŸºç¡€/css-sass.html" class="sidebar-link">css--sass åŸºç¡€</a></li><li><a href="/å‰ç«¯å¼€å‘/åŸºç¡€/node-nodeåŸºç¡€.html" class="sidebar-link">node--node åŸºç¡€</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>reactåŸºç¡€</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>è¿›é˜¶</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>webpack</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w1-æœ€ç®€å•çš„webpack4é¡¹ç›®.html" class="sidebar-link">w1-æœ€ç®€å•çš„webpackæ‰“åŒ…</a></li><li><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w2-åŠ¨æ‰‹æ­å»ºä¸ªvueé¡¹ç›®.html" class="sidebar-link">w2-åŠ¨æ‰‹æ­å»ºä¸ªvueé¡¹ç›®</a></li><li><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html" class="active sidebar-link">w3-webpack4è¯¦è§£</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#æ ¸å¿ƒ" class="sidebar-link">æ ¸å¿ƒ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#entry" class="sidebar-link">entry</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#output" class="sidebar-link">output</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#loaders" class="sidebar-link">loaders</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#plugins" class="sidebar-link">plugins</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#mode" class="sidebar-link">mode</a></li></ul></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#åŸºç¡€ç”¨æ³•" class="sidebar-link">åŸºç¡€ç”¨æ³•</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#js-reactè§£æ" class="sidebar-link">js reactè§£æ</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#css" class="sidebar-link">css</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#å›¾ç‰‡ï¼Œå­—ä½“" class="sidebar-link">å›¾ç‰‡ï¼Œå­—ä½“</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#æ–‡ä»¶ç›‘å¬" class="sidebar-link">æ–‡ä»¶ç›‘å¬</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#çƒ­æ›´æ–°" class="sidebar-link">çƒ­æ›´æ–°</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#æ–‡ä»¶æŒ‡çº¹" class="sidebar-link">æ–‡ä»¶æŒ‡çº¹</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#ä»£ç å‹ç¼©" class="sidebar-link">ä»£ç å‹ç¼©</a></li></ul></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#è¿›é˜¶ç”¨æ³•" class="sidebar-link">è¿›é˜¶ç”¨æ³•</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#æ¸…é™¤æ„å»ºç›®å½•" class="sidebar-link">æ¸…é™¤æ„å»ºç›®å½•</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#postcss-remè½¬æ¢" class="sidebar-link">PostCSS remè½¬æ¢</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#é™æ€èµ„æºå†…è”" class="sidebar-link">é™æ€èµ„æºå†…è”</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#å¤šé¡µé¢æ‰“åŒ…" class="sidebar-link">å¤šé¡µé¢æ‰“åŒ…</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#source-map" class="sidebar-link">source map</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#æå–é¡µé¢å…¬å…±èµ„æº" class="sidebar-link">æå–é¡µé¢å…¬å…±èµ„æº</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#tree-shaking" class="sidebar-link">tree shaking</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#scope-hoisting" class="sidebar-link">scope hoisting</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#ä»£ç åˆ†å‰²" class="sidebar-link">ä»£ç åˆ†å‰²</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#eslint" class="sidebar-link">ESLint</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#æ‰“åŒ…åº“å’Œç»„ä»¶" class="sidebar-link">æ‰“åŒ…åº“å’Œç»„ä»¶</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#ssr" class="sidebar-link">SSR</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#ä¼˜åŒ–æ„å»ºå‘½ä»¤è¡Œæ˜¾ç¤ºæ—¥å¿—" class="sidebar-link">ä¼˜åŒ–æ„å»ºå‘½ä»¤è¡Œæ˜¾ç¤ºæ—¥å¿—</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#æ„å»ºå¼‚å¸¸å’Œä¸­æ–­å¤„ç†" class="sidebar-link">æ„å»ºå¼‚å¸¸å’Œä¸­æ–­å¤„ç†</a></li></ul></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#ç¼–å†™å¯ç»´æŠ¤çš„webpackæ„å»ºé…ç½®" class="sidebar-link">ç¼–å†™å¯ç»´æŠ¤çš„webpackæ„å»ºé…ç½®</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#æ„å»ºé…ç½®åŒ…è®¾è®¡" class="sidebar-link">æ„å»ºé…ç½®åŒ…è®¾è®¡</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#åŠŸèƒ½æ¨¡å—å’Œç›®å½•ç»“æ„" class="sidebar-link">åŠŸèƒ½æ¨¡å—å’Œç›®å½•ç»“æ„</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#eslintè§„èŒƒè„šæœ¬" class="sidebar-link">ESLintè§„èŒƒè„šæœ¬</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#å†’çƒŸæµ‹è¯•" class="sidebar-link">å†’çƒŸæµ‹è¯•</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#å•å…ƒæµ‹è¯•ä¸æµ‹è¯•è¦†ç›–ç‡" class="sidebar-link">å•å…ƒæµ‹è¯•ä¸æµ‹è¯•è¦†ç›–ç‡</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#æŒç»­é›†æˆ" class="sidebar-link">æŒç»­é›†æˆ</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#gitè§„èŒƒå’Œchangelogç”Ÿæˆ" class="sidebar-link">gitè§„èŒƒå’ŒchangeLogç”Ÿæˆ</a></li></ul></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#ä¼˜åŒ–" class="sidebar-link">ä¼˜åŒ–</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#æºç " class="sidebar-link">æºç </a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#ç¼–å†™loaderå’Œplugin" class="sidebar-link">ç¼–å†™loaderå’Œplugin</a></li><li class="sidebar-sub-header"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w3-webpack4è¯¦è§£.html#å®æˆ˜-react" class="sidebar-link">å®æˆ˜ React</a></li></ul></li><li><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w4-è‡ªå·±å®ç°ä¸ªwebpack.html" class="sidebar-link">w4-è‡ªå·±å®ç°ä¸ªwebpack</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>vueæºç </span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>å®æˆ˜</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/å‰ç«¯å¼€å‘/å®æˆ˜/VueUIåº“.html" class="sidebar-link">åŸºäºVueçš„UIåº“</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>å‘¨è¾¹æŠ€æœ¯</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/å‰ç«¯å¼€å‘/å‘¨è¾¹/vuepressæ­å»ºblog.html" class="sidebar-link">vuepressæ­å»ºBlog</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>ğŸ¯---ç›®æ ‡---ğŸ¯</p> <ul><li><a href="#%E6%A0%B8%E5%BF%83">webpack æ ¸å¿ƒ</a></li> <li><a href="#%E5%9F%BA%E7%A1%80%E7%94%A8%E6%B3%95">åŸºç¡€ç”¨æ³•</a></li> <li><a href="#%E8%BF%9B%E9%98%B6%E7%94%A8%E6%B3%95">è¿›é˜¶ç”¨æ³•</a></li> <li><a href="#%E7%BC%96%E5%86%99%E5%8F%AF%E7%BB%B4%E6%8A%A4%E7%9A%84webpack%E6%9E%84%E5%BB%BA%E9%85%8D%E7%BD%AE">ç¼–å†™å¯ç»´æŠ¤æ„å»ºé…ç½®</a></li> <li><a href="#%E4%BC%98%E5%8C%96">ä¼˜åŒ–</a></li> <li><a href="#%E6%BA%90%E7%A0%81">æºç </a></li></ul> <hr> <h2 id="æ ¸å¿ƒ"><a href="#æ ¸å¿ƒ" aria-hidden="true" class="header-anchor">#</a> æ ¸å¿ƒ</h2> <h3 id="entry"><a href="#entry" aria-hidden="true" class="header-anchor">#</a> entry</h3> <p>ä¾èµ–å›¾çš„å…¥å£æ˜¯entry</p> <p>å¯¹äºéä»£ç æ¯”å¦‚å›¾ç‰‡ã€å­—ä½“ä¾èµ–ä¼šä¸æ–­åŠ å…¥åˆ°ä¾èµ–å›¾ä¸­</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å•å…¥å£</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token punctuation">:</span> <span class="token string">'./path/to/entry.js'</span>
<span class="token punctuation">}</span>
<span class="token comment">// å¤šå…¥å£</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    app<span class="token punctuation">:</span> <span class="token string">'./src/app.js'</span><span class="token punctuation">,</span>
    adminApp<span class="token punctuation">:</span> <span class="token string">'./src/adminApp.js'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="output"><a href="#output" aria-hidden="true" class="header-anchor">#</a> output</h3> <p>output ç”¨æ¥å‘Šè¯‰webpackå¦‚ä½•å°†ç¼–è¯‘åçš„æ–‡ä»¶è¾“å‡ºåˆ°ç£ç›˜</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å•å…¥å£</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token punctuation">:</span> <span class="token string">'./src/app.js'</span><span class="token punctuation">,</span>
  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    filename<span class="token punctuation">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span>
    path<span class="token punctuation">:</span> __dirname <span class="token operator">+</span> <span class="token string">'/dist'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// å¤šå…¥å£</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    app<span class="token punctuation">:</span> <span class="token string">'./src/app.js'</span><span class="token punctuation">,</span>
    adminApp<span class="token punctuation">:</span> <span class="token string">'./src/adminApp.js'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    filename<span class="token punctuation">:</span> <span class="token string">'[name].js'</span><span class="token punctuation">,</span> <span class="token comment">// å ä½ç¬¦</span>
    path<span class="token punctuation">:</span> __dirname <span class="token operator">+</span> <span class="token string">'/dist'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="loaders"><a href="#loaders" aria-hidden="true" class="header-anchor">#</a> loaders</h3> <p>webpack å¼€ç®±åªæ”¯æŒjs å’Œ json ï¼Œé€šè¿‡loaderså»æ”¯æŒå…¶ä»–æ–‡ä»¶ç±»å‹ï¼Œå¹¶ä¸”æŠŠä»–ä»¬è½¬åŒ–æˆæœ‰æ•ˆçš„æ¨¡å—ã€‚å¹¶ä¸”å¯ä»¥æ·»åŠ åˆ°ä¾èµ–å›¾ä¸­ã€‚</p> <p>loaderæœ¬èº«æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ¥å—æºæ–‡ä»¶ä½œä¸ºå‚æ•°ï¼Œè¿”å›è½¬æ¢çš„ç»“æœ</p> <p>å¸¸ç”¨ loaders</p> <ul><li>babel-loader</li> <li>css-loader</li> <li>sass-loader</li> <li>ts-loader</li> <li>file-loader</li> <li>raw-loader # å°†æ–‡ä»¶ä»¥å­—ç¬¦ä¸²å½¢å¼å¯¼å…¥</li> <li>thread-loader # å¤šè¿›ç¨‹æ‰“åŒ…jså’Œcss</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.txt$/</span><span class="token punctuation">,</span> <span class="token comment">// æŒ‡å®šåŒ¹é…è§„åˆ™</span>
        use<span class="token punctuation">:</span> <span class="token string">'raw-loader'</span> <span class="token comment">// æŒ‡å®šloader</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="plugins"><a href="#plugins" aria-hidden="true" class="header-anchor">#</a> plugins</h3> <p>æ’ä»¶ç”¨äºbundleæ–‡ä»¶çš„ä¼˜åŒ–ï¼Œ èµ„æºç®¡ç†å’Œç¯å¢ƒå˜é‡æ³¨å…¥ï¼Œä½œç”¨äºæ•´ä¸ªæ„å»ºè¿‡ç¨‹</p> <p>extract-text-webpackplugin å·²ç»æ›¿æ¢æˆmini-css-extract-pluginï¼ŒcommonsChunkPlugin æ›¿æ¢æˆäº† splitchunkspluginã€‚</p> <p>å¸¸ç”¨plugins</p> <ul><li>CommonsChunkPlugin #å°†chunksç›¸åŒçš„æ¨¡å—ä»£ç æå–æˆå…¬ç”¨js, å·²æ·˜æ±°  splitchunksplugin</li> <li>CleanWepackPlugin #æ¸…ç†æ„é€ ç›®å½•</li> <li>ExtractTextWebpackPlugin #å°†cssæ–‡ä»¶ä¸­çš„cssæå–å‡ºæ¥æˆä¸ºå•ç‹¬css å·²æ·˜æ±° miniCssExtractPlugin</li> <li>CopyWebpackPlugin #copy</li> <li>HtmlWebpackPlugin #åˆ›å»ºhtmlæ‰¿è½½è¾“å‡ºçš„bundle</li> <li>UglifyjsWebpackPlugin #å‹ç¼©js</li> <li>zipWebpackPlugin #å°†æ‰“åŒ…èµ„æºç”Ÿæˆzip</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      template<span class="token punctuation">:</span> <span class="token string">'./src/index.html'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="mode"><a href="#mode" aria-hidden="true" class="header-anchor">#</a> mode</h3> <p>modeæŒ‡å®šå½“å‰æ„å»ºç¯å¢ƒ: productionã€ developmentã€none
è®¾ç½®modeå¯ä»¥ç”¨webpackå†…ç½®å‡½æ•°ï¼Œé»˜è®¤æ˜¯None
<img src="/assets/img/webpack-mode.6bb373d6.png" alt="mode"></p> <h2 id="åŸºç¡€ç”¨æ³•"><a href="#åŸºç¡€ç”¨æ³•" aria-hidden="true" class="header-anchor">#</a> åŸºç¡€ç”¨æ³•</h2> <h3 id="js-reactè§£æ"><a href="#js-reactè§£æ" aria-hidden="true" class="header-anchor">#</a> js reactè§£æ</h3> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.js$/</span>
        use<span class="token punctuation">:</span> <span class="token string">'babel-loader'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>.babelrc</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">yarn</span> <span class="token function">add</span> @babel-core @babel/preset-env babel-loader
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token string">'presets'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string">'@babel/preset-env'</span><span class="token punctuation">,</span>  <span class="token comment">// è§£æES6 pluginçš„é›†åˆ</span>
    <span class="token string">'@babel/preset-react'</span> <span class="token comment">// react</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string">'plugins'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string">'@babel/proposal-class-properties'</span> <span class="token comment">// ä¸€ä¸ªpluginå¯¹åº”åŠŸèƒ½</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="css"><a href="#css" aria-hidden="true" class="header-anchor">#</a> css</h3> <p>css-loader åŠ è½½cssæ–‡ä»¶ï¼Œè½¬æ¢æˆcommonjså¯¹è±¡
style-loader å°†æ ·å¼é€šè¿‡ style æ ‡ç­¾æ’å…¥ headä¸­</p> <p>è‡ªå³å‘å·¦é¡ºåºåŠ è½½</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      test<span class="token punctuation">:</span> <span class="token regex">/\.css$/</span>
      use<span class="token punctuation">:</span><span class="token punctuation">[</span>
        <span class="token string">'style-loader'</span><span class="token punctuation">,</span> <span class="token comment">// å’Œæå–miniCssExtractPluginäº’æ–¥ï¼Œ å¯ä»¥æ¢ä¸ºminiCssExtractPlugin.loader</span>
        <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
        <span class="token string">'sass-loader'</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="å›¾ç‰‡ï¼Œå­—ä½“"><a href="#å›¾ç‰‡ï¼Œå­—ä½“" aria-hidden="true" class="header-anchor">#</a> å›¾ç‰‡ï¼Œå­—ä½“</h3> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.(png | svg | jpg | gif)$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token comment">// 'file-loader'</span>
          <span class="token punctuation">{</span>
            loader<span class="token punctuation">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>
            options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
              limit<span class="token punctuation">:</span> <span class="token number">10240</span> <span class="token comment">// å­—èŠ‚</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.(woff|woff2|eot|ttf|otf)$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token string">'file-loader'</span>
      <span class="token punctuation">}</span>      
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="æ–‡ä»¶ç›‘å¬"><a href="#æ–‡ä»¶ç›‘å¬" aria-hidden="true" class="header-anchor">#</a> æ–‡ä»¶ç›‘å¬</h3> <p>å¼€å¯ç›‘å¬</p> <ul><li>å¯åŠ¨webpack --watch</li> <li>webpack.config.js è®¾ç½® watch: true
åŸç†</li></ul> <blockquote><p><img src="/assets/img/webpack-watch.b9f16c1f.png" alt="watch"></p></blockquote> <h3 id="çƒ­æ›´æ–°"><a href="#çƒ­æ›´æ–°" aria-hidden="true" class="header-anchor">#</a> çƒ­æ›´æ–°</h3> <ol><li>ä½¿ç”¨hotModuleReplacementPluginæ’ä»¶
package.json</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>scripts<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token string">'dev'</span><span class="token punctuation">:</span> <span class="token string">'webpack-dev-server'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>webpack.config.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> webpack <span class="token keyword">from</span> <span class="token string">'webpack'</span>

plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>HotModuleReplacementPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
devServer<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  contentBase<span class="token punctuation">:</span> <span class="token string">'./dist'</span><span class="token punctuation">,</span> <span class="token comment">// å¿…é¡»è®¾</span>
  hot<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token comment">// å¦‚æœé…ç½®hotåˆ™ä¼šè‡ªåŠ¨å¼•å…¥ hotModuleReplacementPlugin</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li><p>ä½¿ç”¨webpack-dev-middleware
<img src="/assets/img/webpack-dev-middle.3761fb3c.png" alt="webpack-dev-middleware"></p></li> <li><p>çƒ­æ›´æ–°åŸç†
<img src="/assets/img/webpack-hot.e34176da.png" alt="åŸç†"></p></li></ol> <h3 id="æ–‡ä»¶æŒ‡çº¹"><a href="#æ–‡ä»¶æŒ‡çº¹" aria-hidden="true" class="header-anchor">#</a> æ–‡ä»¶æŒ‡çº¹</h3> <p>ç‰ˆæœ¬ç®¡ç†
ç”Ÿæˆæ–‡ä»¶æŒ‡çº¹åªè¦æœ‰ä¸‰ç§</p> <ul><li>Hash</li> <li>Chunkhash</li> <li>ContentHash</li></ul> <p>js æ–‡ä»¶æŒ‡çº¹</p> <div class="language-js extra-class"><pre class="language-js"><code>output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  filename<span class="token punctuation">:</span> <span class="token string">'[name][chunkhash:8].js'</span><span class="token punctuation">,</span>
  path<span class="token punctuation">:</span> __dirname <span class="token operator">+</span> <span class="token string">'/dist'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>css æ–‡ä»¶æŒ‡çº¹</p> <p>webpack.config.js</p> <div class="language-js extra-class"><pre class="language-js"><code>plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    filename<span class="token punctuation">:</span> <span class="token string">'[name][contenthash:8].css'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre></div><p>å›¾ç‰‡ã€å­—ä½“æ–‡ä»¶æŒ‡çº¹</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.(png | svg | jpg | gif)$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token comment">// 'file-loader'</span>
          <span class="token punctuation">{</span>
            loader<span class="token punctuation">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>
            options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
              limit<span class="token punctuation">:</span> <span class="token number">10240</span> <span class="token comment">// å­—èŠ‚,</span>
              name<span class="token punctuation">:</span> <span class="token string">'img/[name][hash:8].[ext]'</span> <span class="token comment">// æ–‡ä»¶å†…å®¹çš„hashé»˜è®¤md5ç”Ÿæˆ</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>     
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="ä»£ç å‹ç¼©"><a href="#ä»£ç å‹ç¼©" aria-hidden="true" class="header-anchor">#</a> ä»£ç å‹ç¼©</h3> <ol><li>jså‹ç¼©</li></ol> <p>å†…ç½®äº†uglifyjs-webpack-Plugin</p> <ol start="2"><li>css</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">OptimizeCSSAssetsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    assetNameRegExp<span class="token punctuation">:</span> <span class="token regex">/\.css$/g</span><span class="token punctuation">,</span>
    cssProcessor<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cssnano'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre></div><ol start="3"><li>html</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    template<span class="token punctuation">:</span> <span class="token string">'src/search.html'</span><span class="token punctuation">,</span>
    filename<span class="token punctuation">:</span> <span class="token string">'search.html'</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>
    chunks<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'search'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    inject<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    minify<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      html5<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      collapseWhitespace<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      preserveLineBreaks<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      minifyCSS<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      minifyJS<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      removeComments<span class="token punctuation">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    template<span class="token punctuation">:</span> <span class="token string">'src/search.html'</span><span class="token punctuation">,</span>
    filename<span class="token punctuation">:</span> <span class="token string">'search.html'</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>
    chunks<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'index'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    inject<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    minify<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      html5<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      collapseWhitespace<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      preserveLineBreaks<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      minifyCSS<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      minifyJS<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      removeComments<span class="token punctuation">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre></div><h2 id="è¿›é˜¶ç”¨æ³•"><a href="#è¿›é˜¶ç”¨æ³•" aria-hidden="true" class="header-anchor">#</a> è¿›é˜¶ç”¨æ³•</h2> <h3 id="æ¸…é™¤æ„å»ºç›®å½•"><a href="#æ¸…é™¤æ„å»ºç›®å½•" aria-hidden="true" class="header-anchor">#</a> æ¸…é™¤æ„å»ºç›®å½•</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> CleanWebpackPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'clean-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre></div><h3 id="postcss-remè½¬æ¢"><a href="#postcss-remè½¬æ¢" aria-hidden="true" class="header-anchor">#</a> PostCSS remè½¬æ¢</h3> <p>iOSåˆ†è¾¨ç‡
<img src="/assets/img/phone.59770db4.png" alt="phone"></p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
      test<span class="token punctuation">:</span> <span class="token regex">/.less$/</span><span class="token punctuation">,</span>
      use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>
          <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
     
          <span class="token punctuation">{</span>
              loader<span class="token punctuation">:</span> <span class="token string">'postcss-loader'</span><span class="token punctuation">,</span>
              options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                  <span class="token function-variable function">plugins</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
                      <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'autoprefixer'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                          browsers<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'last 2 version'</span><span class="token punctuation">,</span> <span class="token string">'&gt;1%'</span><span class="token punctuation">,</span> <span class="token string">'ios 7'</span><span class="token punctuation">]</span> <span class="token comment">//æ–°ç‰ˆæœ¬æ¨èå†™åœ¨package.json</span>
                      <span class="token punctuation">}</span><span class="token punctuation">)</span>
                  <span class="token punctuation">]</span>
              <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token string">'less-loader'</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
              loader<span class="token punctuation">:</span> <span class="token string">'px2rem-loader'</span><span class="token punctuation">,</span> <span class="token comment">// font-size:12px /*no*/  è¿™æ ·å†™ä¸ä¼šè½¬æ¢</span>
              options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                  remUnit<span class="token punctuation">:</span> <span class="token number">75</span><span class="token punctuation">,</span>
                  remPrecision<span class="token punctuation">:</span> <span class="token number">8</span> <span class="token comment">// å°æ•°ç‚¹åä½æ•°</span>
              <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="é™æ€èµ„æºå†…è”"><a href="#é™æ€èµ„æºå†…è”" aria-hidden="true" class="header-anchor">#</a> é™æ€èµ„æºå†…è”</h3> <ul><li>åˆå§‹åŒ–è„šæœ¬</li> <li>ä¸ŠæŠ¥æ‰“ç‚¹</li> <li>csså†…è”é¿å…é¡µé¢é—ªåŠ¨</li> <li>å‡å°‘httpè¯·æ±‚</li></ul> <p><strong style="color:#f00;">0.5.1æ‰è¡Œï¼Œæ–°ç‰ˆæœ¬å¯¼å‡ºæ¨¡å—export defaultè¿™ä¸ªåœ¨htmlä¸‹ä¸è¡Œ</strong></p> <p>raw-loader å†…è” html</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>$<span class="token punctuation">{</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'raw-loader!babel-loader!./meta.html'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><p>raw-loader å†…è”js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>$<span class="token punctuation">{</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'raw-loader!babel-loader!../node_modules/lib-flexible'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><p>csså†…è”</p> <ol><li>style-loader</li> <li>html-inline-css-webpack-plugin</li></ol> <h3 id="å¤šé¡µé¢æ‰“åŒ…"><a href="#å¤šé¡µé¢æ‰“åŒ…" aria-hidden="true" class="header-anchor">#</a> å¤šé¡µé¢æ‰“åŒ…</h3> <p>glob.syncæ‰¹é‡è·å–å…¥å£</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> glob <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'glob'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// åŠ¨æ€è¿”å› entryå’ŒhtmlWebpackPlugin</span>
<span class="token keyword">const</span> <span class="token function-variable function">setMPA</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> entry <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> htmlWebpackPlugins <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> entryFiles <span class="token operator">=</span> glob<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./src/*/index.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>entryFiles<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> entryFile <span class="token operator">=</span> entryFiles<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">// '/Users/cpselvis/my-project/src/index/index.js'</span>

            <span class="token keyword">const</span> match <span class="token operator">=</span> entryFile<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/src\/(.*)\/index\.js/</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">const</span> pageName <span class="token operator">=</span> match <span class="token operator">&amp;&amp;</span> match<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

            entry<span class="token punctuation">[</span>pageName<span class="token punctuation">]</span> <span class="token operator">=</span> entryFile<span class="token punctuation">;</span>
            htmlWebpackPlugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
                <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                    inlineSource<span class="token punctuation">:</span> <span class="token string">'.css$'</span><span class="token punctuation">,</span>
                    template<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">src/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pageName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/index.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    filename<span class="token punctuation">:</span> `$<span class="token punctuation">{</span>pageName<span class="token punctuation">}</span><span class="token punctuation">.</span>html`<span class="token punctuation">,</span>
                    chunks<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'vendors'</span><span class="token punctuation">,</span> pageName<span class="token punctuation">]</span><span class="token punctuation">,</span>
                    inject<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                    minify<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                        html5<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                        collapseWhitespace<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                        preserveLineBreaks<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                        minifyCSS<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                        minifyJS<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                        removeComments<span class="token punctuation">:</span> <span class="token boolean">false</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        entry<span class="token punctuation">,</span>
        htmlWebpackPlugins
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> entry<span class="token punctuation">,</span> htmlWebpackPlugins <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">setMPA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    entry<span class="token punctuation">:</span> entry<span class="token punctuation">,</span>
    output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        filename<span class="token punctuation">:</span> <span class="token string">'[name]_[chunkhash:8].js'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token operator">...</span>  
      <span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>htmlWebpackPlugins<span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="source-map"><a href="#source-map" aria-hidden="true" class="header-anchor">#</a> source map</h3> <ul><li>source mapå®šä¹‰åˆ°æºä»£ç </li> <li>å¼€å‘ç¯å¢ƒå¼€å¯ çº¿ä¸Šå…³é—­
çº¿ä¸Šé—®é¢˜å¯ä»¥æŠŠsource mapä¸ŠæŠ¥åˆ°ç›‘æ§ç³»ç»Ÿé‡Œï¼Œæ’æŸ¥é—®é¢˜</li></ul> <p>source map å…³é”®å­—</p> <ul><li>eval: ç”¨evalåŒ…è£¹æ¨¡å—ä»£ç </li> <li>source map: äº§ç”Ÿ.mapæ–‡ä»¶</li> <li>cheap: ä¸åŒ…æ‹¬åˆ—ä¿¡æ¯</li> <li>inline: å°†.mapä½œä¸ºDataUrlåµŒå…¥ï¼Œä¸ç”Ÿæˆ.mapæ–‡ä»¶</li> <li>module: åŒ…å«loaderçš„source map</li></ul> <p>source map ç±»å‹
<img src="/assets/img/webpack-source-map.d2e397cc.png" alt="source map"></p> <p>å¼€å¯
webpack.config.js</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  devtool<span class="token punctuation">:</span> <span class="token string">'source-map'</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="æå–é¡µé¢å…¬å…±èµ„æº"><a href="#æå–é¡µé¢å…¬å…±èµ„æº" aria-hidden="true" class="header-anchor">#</a> æå–é¡µé¢å…¬å…±èµ„æº</h3> <ol><li><p>å°†react react-domé€šè¿‡cdnå¼•å…¥ï¼Œä¸æ‰“å…¥bundle</p></li> <li><p>æ–¹æ³•ä¸€ é€šè¿‡html-webpack-exernals-plugin</p></li> <li><p>æ–¹æ³•äºŒ splitChunksPlugin å†…ç½® ä»£ç åˆ†å‰²(CommonsChunkPluginåºŸé™¤)</p> <ul><li><p>3.1 chunkså‚æ•°</p> <ul><li>async å¼‚æ­¥å¼•å…¥çš„åº“è¿›è¡Œåˆ†ç¦» (é»˜è®¤)</li> <li>initial åŒæ­¥å¼•å…¥çš„åº“è¿›è¡Œåˆ†ç¦»</li> <li>all æ‰€æœ‰å¼•å…¥çš„åº“è¿›è¡Œåˆ†ç¦» (æ¨è)</li></ul></li> <li><p>3.2 teståŒ¹é…å‡ºè¦åˆ†ç¦»çš„åŒ…</p></li></ul></li></ol> <h4 id="html-webpack-exernals-plugin"><a href="#html-webpack-exernals-plugin" aria-hidden="true" class="header-anchor">#</a> html-webpack-exernals-plugin</h4> <div class="language-js extra-class"><pre class="language-js"><code>plugins <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackExternalsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            externals<span class="token punctuation">:</span> <span class="token punctuation">[</span>
              <span class="token punctuation">{</span>
                module<span class="token punctuation">:</span> <span class="token string">'react'</span><span class="token punctuation">,</span>
                entry<span class="token punctuation">:</span> <span class="token string">'https://11.url.cn/now/lib/16.2.0/react.min.js'</span><span class="token punctuation">,</span>
                global<span class="token punctuation">:</span> <span class="token string">'React'</span><span class="token punctuation">,</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              <span class="token punctuation">{</span>
                module<span class="token punctuation">:</span> <span class="token string">'react-dom'</span><span class="token punctuation">,</span>
                entry<span class="token punctuation">:</span> <span class="token string">'https://11.url.cn/now/lib/16.2.0/react-dom.min.js'</span><span class="token punctuation">,</span>
                global<span class="token punctuation">:</span> <span class="token string">'ReactDOM'</span><span class="token punctuation">,</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre></div><p>åŒæ—¶ index.html</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>https://11.url.cn/now/lib/16.2.0/react-dom.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span> ...
</code></pre></div><h4 id="splitchunksplugin"><a href="#splitchunksplugin" aria-hidden="true" class="header-anchor">#</a> splitChunksPlugin</h4> <ul><li>å…¬å…±è„šæœ¬åˆ†ç¦», å‡å°‘node_moduleå¼•ç”¨</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  optimization<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    splitChuns<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      chunks<span class="token punctuation">:</span> <span class="token string">'async'</span><span class="token punctuation">,</span>
      minSize<span class="token punctuation">:</span> <span class="token number">30000</span><span class="token punctuation">,</span> <span class="token comment">// 30K,</span>
      maxSize<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      minChunks<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      maxAsyncRequests<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
      maxInitialRequests<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
      automaticNameDelimiter<span class="token punctuation">:</span> <span class="token string">'~'</span><span class="token punctuation">,</span>
      name<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      cacheGroups<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        vendors<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          test<span class="token punctuation">:</span> <span class="token regex">/[\\/]node_modules[\\/]/</span><span class="token punctuation">,</span>
          pripority<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">10</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>åˆ†ç¦»åŸºç¡€åŒ…</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  optimization<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    splitChuns<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      cacheGroups<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        commons<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          test<span class="token punctuation">:</span> <span class="token regex">/(react | react-dom)/</span><span class="token punctuation">,</span>
          name<span class="token punctuation">:</span> <span class="token string">'vendors'</span><span class="token punctuation">,</span>
          chunks<span class="token punctuation">:</span> <span class="token string">'all'</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>åˆ†ç¦»å…¬å…±æ–‡ä»¶</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  optimization<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    splitChuns<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      minSize<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// åˆ†ç¦»åŒ…ä½“ç§¯å¤§å°</span>
      cacheGroups<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        commons<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          name<span class="token punctuation">:</span> <span class="token string">'commons'</span><span class="token punctuation">,</span>
          chunks<span class="token punctuation">:</span> <span class="token string">'all'</span><span class="token punctuation">,</span>
          minChunks<span class="token punctuation">:</span> <span class="token number">2</span> <span class="token comment">// æœ€å°å¼•ç”¨æ¬¡æ•°</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong style="color:#f00;">ä»¥ä¸Šnew HtmlWebpackPluginçš„æ—¶å€™ chunks:['vendors', 'commons', pageName]</strong></p> <h3 id="tree-shaking"><a href="#tree-shaking" aria-hidden="true" class="header-anchor">#</a> tree shaking</h3> <ul><li><p>æ¦‚å¿µï¼š 1ä¸ªæ¨¡å—å¯èƒ½æœ‰å¤šä¸ªæ–¹æ³•ï¼Œåªè¦å…¶ä¸­æŸä¸ªæ–¹æ³•æ•´ä¸ªæ–‡ä»¶éƒ½ä¼šè¢«æ‰“åŒ…ï¼Œtree shakingåªæŠŠç”¨åˆ°çš„æ–¹æ³•æ‰“åŒ…ï¼Œæ²¡ç”¨åˆ°çš„uglifyé˜¶æ®µæ“¦é™¤æ‰</p></li> <li><p>ä½¿ç”¨ï¼š webpacké»˜è®¤æ”¯æŒï¼Œ.babelrcé‡Œè®¾ç½®modulesï¼š falseå³å¯
production modeä¸‹é»˜è®¤å¼€å¯</p></li> <li><p>è¦æ±‚ï¼šå¿…é¡»æ˜¯ES6è¯­æ³•ï¼ŒCJSæ–¹å¼ä¸æ”¯æŒ</p></li> <li><p>åŸç†ï¼šDCE</p> <ul><li>ä»£ç ä¸ä¼šè¢«æ‰§è¡Œï¼Œä¸å¯åˆ°è¾¾</li> <li>ä»£ç æ‰§è¡Œç»“æœä¸ä¼šè¢«ç”¨åˆ°</li> <li>ä»£ç åªä¼šå»å½±å“æ­»å˜é‡(åªå†™ä¸è¯»)</li></ul> <blockquote><p>åˆ©ç”¨ES6æ¨¡å—çš„ç‰¹ç‚¹</p> <ul><li>åªèƒ½ä½œä¸ºæ¨¡å—é¡¶å±‚çš„è¯­å¥å‡ºç°</li> <li>importçš„æ¨¡å—ååªèƒ½æ˜¯å­—ç¬¦ä¸²å¸¸é‡</li> <li>import bindingæ˜¯immutablede  // ä¸å¯ä¿®æ”¹</li></ul></blockquote></li></ul> <h3 id="scope-hoisting"><a href="#scope-hoisting" aria-hidden="true" class="header-anchor">#</a> scope hoisting</h3> <p>ç°è±¡ï¼š æ„å»ºåçš„ä»£ç å­˜åœ¨å¤§é‡é—­åŒ…</p> <ol><li>webpackæ¨¡å—è½¬æ¢</li></ol> <ul><li>æ¨¡å—ä¼šè¢«å¸¦ä¸Šä¸€å±‚åŒ…è£¹</li> <li>importä¼šè¢«è½¬åŒ–æˆ__webpack_require</li></ul> <ol start="2"><li>scope hoistingåŸç†</li></ol> <ul><li>å°†æ‰€æœ‰æ¨¡å—ä»£ç ï¼ŒæŒ‰ç…§å¼•ç”¨é¡ºåºæ”¾åœ¨ä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸï¼Œç„¶åé€‚å½“çš„é‡å‘½åä¸€äº›å˜é‡ï¼Œé˜²æ­¢å˜é‡å†²çª</li></ul> <ol start="3"><li>ä½¿ç”¨</li></ol> <ul><li>4 webpack modeä¸ºproductioné»˜è®¤å¼€å¯</li> <li>3 pluginsé‡Œ new webpack.optimize.ModuleConcatenationPlugin()</li> <li>å¿…é¡»æ˜¯es6è¯­æ³•ï¼ŒCJSä¸æ”¯æŒ å› ä¸ºä¸èƒ½åŠ¨æ€åˆ†æä¾èµ–</li></ul> <h3 id="ä»£ç åˆ†å‰²"><a href="#ä»£ç åˆ†å‰²" aria-hidden="true" class="header-anchor">#</a> ä»£ç åˆ†å‰²</h3> <p>å°†ä½ çš„ä»£ç åº“åˆ†å‰²æˆchunks(è¯­å—), å½“ä»£ç è¿è¡Œéœ€è¦ä»–ä»¬çš„æ—¶å€™å†åŠ è½½</p> <p>ä½¿ç”¨åœºæ™¯ï¼š</p> <ul><li>æŠ½ç¦»ç›¸åŒä»£ç åˆ°å…±äº«å—</li> <li>è„šæœ¬æ‡’åŠ è½½ï¼Œåˆå§‹ä¸‹è½½æ›´å°
<blockquote><p>æ‡’åŠ è½½æ–¹å¼</p> <p>cjs: require.ensure</p> <p>es6: åŠ¨æ€import ç›®å‰åŸç”Ÿæ²¡æ”¯æŒï¼Œéœ€è¦babelè½¬æ¢</p></blockquote></li></ul> <p>åŠ¨æ€import</p> <div class="language-js extra-class"><pre class="language-js"><code>npm i @babel<span class="token operator">/</span>plugin<span class="token operator">-</span>syntax<span class="token operator">-</span>dynamic<span class="token operator">-</span><span class="token keyword">import</span>  <span class="token operator">-</span><span class="token constant">D</span>
<span class="token comment">// .babelrc</span>
plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>@babel<span class="token operator">/</span>plugin<span class="token operator">-</span>syntax<span class="token operator">-</span>dynamic<span class="token punctuation">]</span> 
</code></pre></div><h3 id="eslint"><a href="#eslint" aria-hidden="true" class="header-anchor">#</a> ESLint</h3> <ol><li>åˆ¶å®šå›¢é˜ŸESLintè§„èŒƒ</li></ol> <blockquote><ul><li>ä¸é‡å¤é€ è½®å­ï¼ŒåŸºäºrecommendé…ç½®æ”¹è¿›</li> <li>èƒ½å¤Ÿå¸®åŠ©å‘ç°ä»£ç é”™è¯¯çš„è§„åˆ™å…¨éƒ¨å¼€å¯</li> <li>å¸®åŠ©å›¢é˜Ÿä»£ç é£æ ¼ç»Ÿä¸€ï¼Œè€Œä¸æ˜¯é™åˆ¶å¼€å‘ä½“éªŒ</li></ul></blockquote> <ol start="2"><li>è½åœ°</li></ol> <ul><li>å’ŒCI/CDç³»ç»Ÿé›†æˆ</li> <li>å’Œwebpackç»§æ‰¿ ä½¿ç”¨eslint-loader</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      test<span class="token punctuation">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>
      use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
        <span class="token string">'eslint-loader'</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>.eslintrc.js</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string">'parser'</span><span class="token punctuation">:</span> <span class="token string">'babel-eslint'</span><span class="token punctuation">,</span>
  <span class="token string">'extends'</span><span class="token punctuation">:</span> <span class="token string">'airbnb'</span><span class="token punctuation">,</span>
  <span class="token string">'env'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">'browser'</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token string">'node'</span><span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">'rules'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">'semi'</span><span class="token punctuation">:</span> <span class="token string">'error'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="æ‰“åŒ…åº“å’Œç»„ä»¶"><a href="#æ‰“åŒ…åº“å’Œç»„ä»¶" aria-hidden="true" class="header-anchor">#</a> æ‰“åŒ…åº“å’Œç»„ä»¶</h3> <p>webpacké™¤äº†å¯ä»¥ç”¨æ¥æ‰“åŒ…åº”ç”¨ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥æ‰“åŒ…jsåº“
å…¥å£</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">=</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./dist/large-number.min.js'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./dist/large-number.js'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>package.json</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;large-number&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.1&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;big number add&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;main&quot;</span><span class="token operator">:</span> <span class="token string">&quot;index.js&quot;</span><span class="token punctuation">,</span> <span class="token comment">// åº“æ‰“åŒ…å¿…é¡»æœ‰main</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;prepublish&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;keywords&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;author&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;license&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ISC&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;terser-webpack-plugin&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.3.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;webpack&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.34.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;webpack-cli&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.3.4&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>webpack.config.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> TerserPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'terser-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">'large-number'</span><span class="token punctuation">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
      <span class="token string">'large-number.min'</span><span class="token punctuation">:</span> <span class="token string">'./src/index.js'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      filename<span class="token punctuation">:</span> <span class="token string">'[name].js'</span><span class="token punctuation">,</span>
      library<span class="token punctuation">:</span> <span class="token string">'largeNumber'</span><span class="token punctuation">,</span>
      libraryTarget<span class="token punctuation">:</span> <span class="token string">'umd'</span><span class="token punctuation">,</span>
      libraryExport<span class="token punctuation">:</span> <span class="token string">'default'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  mode<span class="token punctuation">:</span> <span class="token string">'none'</span><span class="token punctuation">,</span> <span class="token comment">// ä¸å‹ç¼©</span>
  optimization<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token comment">// åªå‹ç¼© min</span>
      minimize<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      minimizer<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
              include<span class="token punctuation">:</span> <span class="token regex">/\.min\.js$/</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æ‰“åŒ…å®Œæˆå¯ä»¥å‘å¸ƒnpm</p> <h3 id="ssr"><a href="#ssr" aria-hidden="true" class="header-anchor">#</a> SSR</h3> <ul><li>ä»€ä¹ˆæ˜¯æ¸²æŸ“ï¼š</li></ul> <p>html + css + js + data ===&gt; æ¸²æŸ“åçš„html</p> <ul><li>æœåŠ¡ç«¯æ¸²æŸ“ï¼š</li></ul> <p>æ‰€æœ‰æ¨¡æ¿ç­‰èµ„æºå­˜å‚¨åœ¨æœåŠ¡ç«¯ <br>
å†…ç½‘æœºå™¨æ‹‰å–æ•°æ®æ›´å¿«<br>
ä¸€ä¸ªhtmlè¿”å›æ‰€æœ‰æ•°æ®</p> <p><img src="/assets/img/ssr-process.21ce07ab.png" alt="äº¤äº’è¿‡ç¨‹">
SSRçš„æ ¸å¿ƒæ˜¯å‡å°‘è¯·æ±‚
ä¼˜åŠ¿ï¼Œå‡å°‘ç™½å±æ—¶é—´ï¼Œå¯¹SEOå‹å¥½</p> <p>ps.</p> <blockquote><p>å¤§å‚æ˜¯æœ‰ä¸€å¥—æ¯”è¾ƒå®Œå–„çš„CI/CDå·¥ä½œæµç¨‹ï¼Œæ¯”å¦‚ï¼šGitlab CIæˆ–è€…Jenkins CIç­‰ç­‰ã€‚æ¯æ¬¡ä»£ç pushéƒ½ä¼šç»è¿‡CIé˜¶æ®µï¼Œä¼šå¼€ä¸€ä¸ªDockeré•œåƒè·‘ä»»åŠ¡ã€‚è¿›è¡Œä»£ç æ‰“åŒ…æ„å»ºã€å•å…ƒæµ‹è¯•å’Œä»£ç ESLintæ£€æŸ¥ã€‚</p></blockquote> <blockquote><p>å¦‚æœæ²¡é—®é¢˜ï¼Œåˆ™ä¼šè¿›è¡Œæµ‹è¯•ç¯å¢ƒæˆ–è€…ç”Ÿäº§ç¯å¢ƒçš„ä»£ç éƒ¨ç½²ï¼Œè¿™ä¸ªé˜¶æ®µä¼šç»å†Code Reviewï¼Œæ‰“å‡ºç‰ˆæœ¬åŒ…ï¼ŒåŒ…å‡çº§ä¸‹å‘åˆ°æŒ‡å®šæœºå™¨ã€‚ç„¶åå®Œæˆéƒ¨ç½²æµç¨‹ã€‚</p></blockquote> <h4 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" aria-hidden="true" class="header-anchor">#</a> ä»£ç å®ç°</h4> <ul><li>æœåŠ¡ç«¯
<ul><li>ä½¿ç”¨react-dom/serverçš„renderToStringæ–¹æ³•å°†reactæ¸²æŸ“æˆå­—ç¬¦ä¸²</li> <li>æœåŠ¡ç«¯è·¯ç”±è¿”å›å¯¹åº”çš„æ¨¡æ¿</li></ul></li> <li>å®¢æˆ·ç«¯
<ul><li>æ‰“åŒ…å‡ºé’ˆå¯¹æœåŠ¡ç«¯çš„ç»„ä»¶</li></ul></li></ul> <p>webpack.ssr.config</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'use strict'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> glob <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'glob'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mini-css-extract-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> OptimizeCSSAssetsPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'optimize-css-assets-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> CleanWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'clean-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> HtmlWebpackExternalsPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-externals-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> FriendlyErrorsWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'friendly-errors-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">setMPA</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> entry <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> htmlWebpackPlugins <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> entryFiles <span class="token operator">=</span> glob<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'./src/*/index-server.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>entryFiles<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> entryFile <span class="token operator">=</span> entryFiles<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token comment">// '/Users/cpselvis/my-project/src/index/index.js'</span>

            <span class="token keyword">const</span> match <span class="token operator">=</span> entryFile<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/src\/(.*)\/index-server\.js/</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">const</span> pageName <span class="token operator">=</span> match <span class="token operator">&amp;&amp;</span> match<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>pageName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                entry<span class="token punctuation">[</span>pageName<span class="token punctuation">]</span> <span class="token operator">=</span> entryFile<span class="token punctuation">;</span>
                htmlWebpackPlugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
                    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                        inlineSource<span class="token punctuation">:</span> <span class="token string">'.css$'</span><span class="token punctuation">,</span>
                        template<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">src/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pageName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/index.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        filename<span class="token punctuation">:</span> `$<span class="token punctuation">{</span>pageName<span class="token punctuation">}</span><span class="token punctuation">.</span>html`<span class="token punctuation">,</span>
                        chunks<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'vendors'</span><span class="token punctuation">,</span> pageName<span class="token punctuation">]</span><span class="token punctuation">,</span>
                        inject<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                        minify<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                            html5<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                            collapseWhitespace<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                            preserveLineBreaks<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                            minifyCSS<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                            minifyJS<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                            removeComments<span class="token punctuation">:</span> <span class="token boolean">false</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        entry<span class="token punctuation">,</span>
        htmlWebpackPlugins
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> entry<span class="token punctuation">,</span> htmlWebpackPlugins <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">setMPA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    entry<span class="token punctuation">:</span> entry<span class="token punctuation">,</span>
    output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        filename<span class="token punctuation">:</span> <span class="token string">'[name]-server.js'</span><span class="token punctuation">,</span>
        libraryTarget<span class="token punctuation">:</span> <span class="token string">'umd'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    mode<span class="token punctuation">:</span> <span class="token string">'none'</span><span class="token punctuation">,</span>
    module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                test<span class="token punctuation">:</span> <span class="token regex">/.js$/</span><span class="token punctuation">,</span>
                use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
                    <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
                    <span class="token operator">/</span><span class="token operator">/</span> <span class="token string">'eslint-loader'</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                test<span class="token punctuation">:</span> <span class="token regex">/.css$/</span><span class="token punctuation">,</span>
                use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
                    MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>
                    <span class="token string">'css-loader'</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                test<span class="token punctuation">:</span> <span class="token regex">/.less$/</span><span class="token punctuation">,</span>
                use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
                    MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>
                    <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
                    <span class="token string">'less-loader'</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>
                        loader<span class="token punctuation">:</span> <span class="token string">'postcss-loader'</span><span class="token punctuation">,</span>
                        options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                            <span class="token function-variable function">plugins</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
                                <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'autoprefixer'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                                    browsers<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'last 2 version'</span><span class="token punctuation">,</span> <span class="token string">'&gt;1%'</span><span class="token punctuation">,</span> <span class="token string">'ios 7'</span><span class="token punctuation">]</span>
                                <span class="token punctuation">}</span><span class="token punctuation">)</span>
                            <span class="token punctuation">]</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>
                        loader<span class="token punctuation">:</span> <span class="token string">'px2rem-loader'</span><span class="token punctuation">,</span>
                        options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                            remUnit<span class="token punctuation">:</span> <span class="token number">75</span><span class="token punctuation">,</span>
                            remPrecision<span class="token punctuation">:</span> <span class="token number">8</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                test<span class="token punctuation">:</span> <span class="token regex">/.(png|jpg|gif|jpeg)$/</span><span class="token punctuation">,</span>
                use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
                    <span class="token punctuation">{</span>
                        loader<span class="token punctuation">:</span> <span class="token string">'file-loader'</span><span class="token punctuation">,</span>
                        options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                            name<span class="token punctuation">:</span> <span class="token string">'[name]_[hash:8].[ext]'</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                test<span class="token punctuation">:</span> <span class="token regex">/.(woff|woff2|eot|ttf|otf)$/</span><span class="token punctuation">,</span>
                use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
                    <span class="token punctuation">{</span>
                        loader<span class="token punctuation">:</span> <span class="token string">'file-loader'</span><span class="token punctuation">,</span>
                        options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                            name<span class="token punctuation">:</span> <span class="token string">'[name]_[hash:8][ext]'</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            filename<span class="token punctuation">:</span> <span class="token string">'[name]_[contenthash:8].css'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name">OptimizeCSSAssetsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            assetNameRegExp<span class="token punctuation">:</span> <span class="token regex">/\.css$/g</span><span class="token punctuation">,</span>
            cssProcessor<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cssnano'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token operator">/</span><span class="token operator">/</span> <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackExternalsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token operator">/</span><span class="token operator">/</span>     externals<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token operator">/</span><span class="token operator">/</span>       <span class="token punctuation">{</span>
        <span class="token operator">/</span><span class="token operator">/</span>         module<span class="token punctuation">:</span> <span class="token string">'react'</span><span class="token punctuation">,</span>
        <span class="token operator">/</span><span class="token operator">/</span>         entry<span class="token punctuation">:</span> <span class="token string">'https://11.url.cn/now/lib/16.2.0/react.min.js'</span><span class="token punctuation">,</span>
        <span class="token operator">/</span><span class="token operator">/</span>         global<span class="token punctuation">:</span> <span class="token string">'React'</span><span class="token punctuation">,</span>
        <span class="token operator">/</span><span class="token operator">/</span>       <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token operator">/</span><span class="token operator">/</span>       <span class="token punctuation">{</span>
        <span class="token operator">/</span><span class="token operator">/</span>         module<span class="token punctuation">:</span> <span class="token string">'react-dom'</span><span class="token punctuation">,</span>
        <span class="token operator">/</span><span class="token operator">/</span>         entry<span class="token punctuation">:</span> <span class="token string">'https://11.url.cn/now/lib/16.2.0/react-dom.min.js'</span><span class="token punctuation">,</span>
        <span class="token operator">/</span><span class="token operator">/</span>         global<span class="token punctuation">:</span> <span class="token string">'ReactDOM'</span><span class="token punctuation">,</span>
        <span class="token operator">/</span><span class="token operator">/</span>       <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token operator">/</span><span class="token operator">/</span>     <span class="token punctuation">]</span>
        <span class="token operator">/</span><span class="token operator">/</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name">FriendlyErrorsWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>done<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">stats</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>stats<span class="token punctuation">.</span>compilation<span class="token punctuation">.</span>errors <span class="token operator">&amp;&amp;</span> stats<span class="token punctuation">.</span>compilation<span class="token punctuation">.</span>errors<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> process<span class="token punctuation">.</span>argv<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'--watch'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'build error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>    
    <span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>htmlWebpackPlugins<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token operator">/</span><span class="token operator">/</span> optimization<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token operator">/</span><span class="token operator">/</span>     splitChunks<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token operator">/</span><span class="token operator">/</span>         minSize<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token operator">/</span><span class="token operator">/</span>         cacheGroups<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token operator">/</span><span class="token operator">/</span>             commons<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token operator">/</span><span class="token operator">/</span>                 name<span class="token punctuation">:</span> <span class="token string">'commons'</span><span class="token punctuation">,</span>
    <span class="token operator">/</span><span class="token operator">/</span>                 chunks<span class="token punctuation">:</span> <span class="token string">'all'</span><span class="token punctuation">,</span>
    <span class="token operator">/</span><span class="token operator">/</span>                 minChunks<span class="token punctuation">:</span> <span class="token number">2</span>
    <span class="token operator">/</span><span class="token operator">/</span>             <span class="token punctuation">}</span>
    <span class="token operator">/</span><span class="token operator">/</span>         <span class="token punctuation">}</span>
    <span class="token operator">/</span><span class="token operator">/</span>     <span class="token punctuation">}</span>
    <span class="token operator">/</span><span class="token operator">/</span> <span class="token punctuation">}</span>
    stats<span class="token punctuation">:</span> <span class="token string">'errors-only'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>server expressæœåŠ¡å™¨</p> <p>å®é™…å°±æ˜¯æŠŠç»„ä»¶è½¬åŒ–æˆå­—ç¬¦ä¸²ï¼Œæ’å…¥æ¨¡æ¿ï¼Œç„¶åé€šè¿‡æœåŠ¡å™¨è¿”å›</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> window <span class="token operator">===</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    global<span class="token punctuation">.</span>window <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span>
    renderToString
<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'react-dom/server'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">SSR</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../dist/search-server'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> template <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../dist/search.html'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./data.json'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">server</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">port</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/search'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> html <span class="token operator">=</span> <span class="token function">renderMarkup</span><span class="token punctuation">(</span><span class="token function">renderToString</span><span class="token punctuation">(</span><span class="token constant">SSR</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Server is running on port:'</span> <span class="token operator">+</span> port<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">server</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span> <span class="token operator">||</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">renderMarkup</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> dataStr <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ç”¨å ä½ç¬¦è§£å†³cssä¸æ˜¾ç¤ºé—®é¢˜</span>
    <span class="token keyword">return</span> template<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'&lt;!--HTML_PLACEHOLDER--&gt;'</span><span class="token punctuation">,</span> str<span class="token punctuation">)</span> 
        <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'&lt;!--INITIAL_DATA_PLACEHOLDER--&gt;'</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;script&gt;window.__initial_data=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>dataStr<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/script&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>å¯¹åº”çš„ç»„ä»¶çš„æ”¹é€ </p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'use strict'</span><span class="token punctuation">;</span>

<span class="token comment">// import React from 'react';</span>
<span class="token comment">// import largeNumber from 'large-number';</span>
<span class="token comment">// import logo from './images/logo.png';</span>
<span class="token comment">// import './search.less';</span>
<span class="token keyword">const</span> React <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'react'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> largeNumber <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'large-number'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> logo <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./images/logo.png'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> s <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./search.less'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Search</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>

    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token operator">...</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
            Text<span class="token punctuation">:</span> <span class="token keyword">null</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">loadComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./text.js'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">Text</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                Text<span class="token punctuation">:</span> Text<span class="token punctuation">.</span>default
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span> Text <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>
        <span class="token keyword">const</span> addResult <span class="token operator">=</span> <span class="token function">largeNumber</span><span class="token punctuation">(</span><span class="token string">'999'</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;search-text&quot;</span><span class="token operator">&gt;</span>
            <span class="token punctuation">{</span>
                Text <span class="token operator">?</span> <span class="token operator">&lt;</span>Text <span class="token operator">/</span><span class="token operator">&gt;</span> <span class="token punctuation">:</span> <span class="token keyword">null</span>
            <span class="token punctuation">}</span>
            <span class="token punctuation">{</span> addResult <span class="token punctuation">}</span>
            æœç´¢æ–‡å­—çš„å†…å®¹<span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token punctuation">{</span> logo <span class="token punctuation">}</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadComponent</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token operator">&lt;</span>Search <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="å­˜åœ¨å·®å¼‚"><a href="#å­˜åœ¨å·®å¼‚" aria-hidden="true" class="header-anchor">#</a> å­˜åœ¨å·®å¼‚</h4> <ul><li>nodeæ²¡æœ‰æµè§ˆå™¨å…¨å±€å˜é‡
<ul><li>ç»„ä»¶é€‚é…ï¼š å°†ä¸å…¼å®¹çš„ç»„ä»¶æŒ‰ç…§æ‰“åŒ…ç¯å¢ƒè¿›è¡Œé€‚é…</li> <li>è¯·æ±‚é€‚é…ï¼š å°†fetchæˆ–è€…ajaxè¯·æ±‚æ”¹æˆisomorphic-fetch æˆ–è€… axios</li></ul></li> <li>æ ·å¼é—®é¢˜
<ul><li>æœåŠ¡ç«¯æ‰“åŒ…é€šè¿‡ignore-loaderå¿½ç•¥æ‰cssè§£æ</li> <li>å°†style-loaderæ›¿æ¢æˆ isomorphic-style-loader</li></ul></li></ul> <h4 id="è§£å†³æ ·å¼ä¸æ˜¾ç¤ºé—®é¢˜"><a href="#è§£å†³æ ·å¼ä¸æ˜¾ç¤ºé—®é¢˜" aria-hidden="true" class="header-anchor">#</a> è§£å†³æ ·å¼ä¸æ˜¾ç¤ºé—®é¢˜</h4> <p>ä½¿ç”¨æ‰“åŒ…å‡ºæ¥çš„æµè§ˆå™¨ç«¯htmlä¸ºæ¨¡æ¿<br>
è®¾ç½®å ä½ç¬¦ï¼ŒåŠ¨æ€æ’å…¥ç»„ä»¶</p> <p>index.html</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    ${ require('raw-loader!./meta.html')}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">$<span class="token punctuation">{</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'raw-loader!babel-loader!../../node_modules/lib-flexible/flexible.js'</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token comment">&lt;!--HTML_PLACEHOLDER--&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>https://11.url.cn/now/lib/16.2.0/react.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>https://11.url.cn/now/lib/16.2.0/react-dom.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--INITIAL_DATA_PLACEHOLDER--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="ä¼˜åŒ–æ„å»ºå‘½ä»¤è¡Œæ˜¾ç¤ºæ—¥å¿—"><a href="#ä¼˜åŒ–æ„å»ºå‘½ä»¤è¡Œæ˜¾ç¤ºæ—¥å¿—" aria-hidden="true" class="header-anchor">#</a> ä¼˜åŒ–æ„å»ºå‘½ä»¤è¡Œæ˜¾ç¤ºæ—¥å¿—</h3> <p><img src="/assets/img/webpack-stats.00d36e9c.png" alt="ç»Ÿè®¡ä¿¡æ¯"></p> <p>ä½¿ç”¨friendly-errors-webpack-plugin</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">FriendlyErrorsWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  stats<span class="token punctuation">:</span> <span class="token string">'error-only'</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="æ„å»ºå¼‚å¸¸å’Œä¸­æ–­å¤„ç†"><a href="#æ„å»ºå¼‚å¸¸å’Œä¸­æ–­å¤„ç†" aria-hidden="true" class="header-anchor">#</a> æ„å»ºå¼‚å¸¸å’Œä¸­æ–­å¤„ç†</h3> <p>CI/CDçš„piplineåè€…å‘å¸ƒç³»ç»Ÿéœ€è¦çŸ¥é“æ„å»ºæ˜¯å¦æˆåŠŸ<br>
æ¯æ¬¡æ„å»ºå®Œæˆåè¾“å…¥ echo $? è·å–é”™è¯¯ç  <br>
Node.jsçš„process.exitè§„èŒƒ</p> <blockquote><p>0 ä¾¿æ˜¯æˆåŠŸï¼Œå›è°ƒå‡½æ•°ä¸­ errä¸ºnull
é0è¡¨ç¤ºå¤±è´¥ï¼Œ å›è°ƒä¸­ errä¸ä¸ºnull err.codeå°±æ˜¯ä¼ ç»™exitçš„æ•°å­—
å¦‚ä½•ä¸»åŠ¨æ•è·å¹¶å¤„ç†æ„å»ºé”™è¯¯
compilerå¯¹è±¡åœ¨æ¯æ¬¡æ„å»ºç»“æŸåä¼šè§¦å‘doneè¿™ä¸ªhook, process.exitä¸»åŠ¨å¤„ç†æ„å»ºæŠ¥é”™</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>done<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">stats</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// this æ˜¯ compiler</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>stats<span class="token punctuation">.</span>compilation<span class="token punctuation">.</span>errors <span class="token operator">&amp;&amp;</span> stats<span class="token punctuation">.</span>compilation<span class="token punctuation">.</span>errors<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> process<span class="token punctuation">.</span>argv<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'--watch'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'build error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¯ä»¥ä¸ŠæŠ¥é”™è¯¯ç­‰æ“ä½œ</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="ç¼–å†™å¯ç»´æŠ¤çš„webpackæ„å»ºé…ç½®"><a href="#ç¼–å†™å¯ç»´æŠ¤çš„webpackæ„å»ºé…ç½®" aria-hidden="true" class="header-anchor">#</a> ç¼–å†™å¯ç»´æŠ¤çš„webpackæ„å»ºé…ç½®</h2> <h3 id="æ„å»ºé…ç½®åŒ…è®¾è®¡"><a href="#æ„å»ºé…ç½®åŒ…è®¾è®¡" aria-hidden="true" class="header-anchor">#</a> æ„å»ºé…ç½®åŒ…è®¾è®¡</h3> <ol><li>æ„å»ºé…ç½®æŠ½ç¦»æˆnpmåŒ…çš„æ„ä¹‰</li></ol> <ul><li>é€šç”¨å‹
<ul><li>ä¸šåŠ¡å¼€å‘è€…æ— éœ€å…³æ³¨æ„å»ºé…ç½®</li> <li>ç»Ÿä¸€å›¢é˜Ÿæ„å»ºè„šæœ¬</li></ul></li> <li>å¯ç»´æŠ¤æ€§
<ul><li>æ„å»ºé…ç½®åˆç†çš„æ‹†åˆ†</li> <li>READMEï¼ŒChangeLogç­‰</li></ul></li> <li>è´¨é‡
<ul><li>å†’çƒŸæµ‹è¯•ï¼Œå•å…ƒæµ‹è¯•ï¼Œ æµ‹è¯•è¦†ç›–ç‡</li> <li>æŒç»­é›†æˆ</li></ul></li></ul> <ol start="2"><li>æ„å»ºé…ç½®ç®¡ç†çš„å¯é€‰æ–¹æ¡ˆ</li></ol> <ul><li>é€šè¿‡å¤šä¸ªé…ç½®æ–‡ä»¶ç®¡ç†ä¸é€šç¯å¢ƒçš„æ„å»º</li> <li>å°†æ„å»ºé…ç½®è®¾è®¡æˆä¸€ä¸ªåº“ å¦‚ hjs-webpack Neutrino webpack-blocks</li> <li>æŠ½æˆä¸€ä¸ªå·¥å…·è¿›è¡Œç®¡ç† å¦‚ create-react-app kyt nwb</li> <li>å°†æ‰€æœ‰é…ç½®æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ï¼Œ é€šè¿‡ --envå‚æ•°æ§åˆ¶åˆ†æ”¯é€‰æ‹©</li></ul> <p>å›¢é˜Ÿè§„æ¨¡ä¸å¤§å¯ä»¥ç”¨ 1.2 å›¢é˜Ÿæœ‰å®åŠ›å¯ä»¥è€ƒè™‘3</p> <h3 id="åŠŸèƒ½æ¨¡å—å’Œç›®å½•ç»“æ„"><a href="#åŠŸèƒ½æ¨¡å—å’Œç›®å½•ç»“æ„" aria-hidden="true" class="header-anchor">#</a> åŠŸèƒ½æ¨¡å—å’Œç›®å½•ç»“æ„</h3> <p>å¤šé…ç½®æ–‡ä»¶æ–¹æ¡ˆ
<img src="/assets/img/webpack-module-design.a078a13f.png" alt="æ„å»ºåŒ…åŠŸèƒ½è®¾è®¡"></p> <p>ç›®å½•ç»“æ„<br> <img src="/assets/img/webpack-file.a05fe626.png" alt="ç›®å½•ç»“æ„">
webpack.base.js</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">const</span> autoprefixer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'autoprefixer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> glob <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'glob'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> CleanWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'clean-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> FriendlyErrorsWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'friendly-errors-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mini-css-extract-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> projectRoot <span class="token operator">=</span> process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">setMPA</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> entry <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> htmlWebpackPlugins <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> entryFiles <span class="token operator">=</span> glob<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>projectRoot<span class="token punctuation">,</span> <span class="token string">'./src/*/index.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>entryFiles<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> entryFile <span class="token operator">=</span> entryFiles<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token comment">// '/Users/cpselvis/my-project/src/index/index.js'</span>

      <span class="token keyword">const</span> match <span class="token operator">=</span> entryFile<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/src\/(.*)\/index\.js/</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> pageName <span class="token operator">=</span> match <span class="token operator">&amp;&amp;</span> match<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

      entry<span class="token punctuation">[</span>pageName<span class="token punctuation">]</span> <span class="token operator">=</span> entryFile<span class="token punctuation">;</span>
      <span class="token keyword">return</span> htmlWebpackPlugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
        <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          inlineSource<span class="token punctuation">:</span> <span class="token string">'.css$'</span><span class="token punctuation">,</span>
          template<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>projectRoot<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./src/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pageName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/index.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          filename<span class="token punctuation">:</span> `$<span class="token punctuation">{</span>pageName<span class="token punctuation">}</span><span class="token punctuation">.</span>html`<span class="token punctuation">,</span>
          chunks<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'vendors'</span><span class="token punctuation">,</span> pageName<span class="token punctuation">]</span><span class="token punctuation">,</span>
          inject<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          minify<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            html5<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            collapseWhitespace<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            preserveLineBreaks<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            minifyCSS<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            minifyJS<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            removeComments<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    entry<span class="token punctuation">,</span>
    htmlWebpackPlugins<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> entry<span class="token punctuation">,</span> htmlWebpackPlugins <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">setMPA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token punctuation">:</span> entry<span class="token punctuation">,</span>
  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>projectRoot<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    filename<span class="token punctuation">:</span> <span class="token string">'[name]_[chunkhash:8].js'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/.js$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            loader<span class="token punctuation">:</span> <span class="token string">'babel-loader'</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/.css$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>
          <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/.less$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>
          <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
          <span class="token string">'less-loader'</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            loader<span class="token punctuation">:</span> <span class="token string">'postcss-loader'</span><span class="token punctuation">,</span>
            options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
              <span class="token function-variable function">plugins</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
                <span class="token function">autoprefixer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                  browsers<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'last 2 version'</span><span class="token punctuation">,</span> <span class="token string">'&gt;1%'</span><span class="token punctuation">,</span> <span class="token string">'ios 7'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            loader<span class="token punctuation">:</span> <span class="token string">'px2rem-loader'</span><span class="token punctuation">,</span>
            options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
              remUnit<span class="token punctuation">:</span> <span class="token number">75</span><span class="token punctuation">,</span>
              remPrecision<span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/.(png|jpg|gif|jpeg)$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            loader<span class="token punctuation">:</span> <span class="token string">'file-loader'</span><span class="token punctuation">,</span>
            options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
              name<span class="token punctuation">:</span> <span class="token string">'[name]_[hash:8].[ext]'</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/.(woff|woff2|eot|ttf|otf)$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            loader<span class="token punctuation">:</span> <span class="token string">'file-loader'</span><span class="token punctuation">,</span>
            options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
              name<span class="token punctuation">:</span> <span class="token string">'[name]_[hash:8][ext]'</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      filename<span class="token punctuation">:</span> <span class="token string">'[name]_[contenthash:8].css'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">FriendlyErrorsWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span> <span class="token function">errorPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>done<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">stats</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>stats<span class="token punctuation">.</span>compilation<span class="token punctuation">.</span>errors <span class="token operator">&amp;&amp;</span> stats<span class="token punctuation">.</span>compilation<span class="token punctuation">.</span>errors<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> process<span class="token punctuation">.</span>argv<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'--watch'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>htmlWebpackPlugins<span class="token punctuation">)</span><span class="token punctuation">,</span>
  stats<span class="token punctuation">:</span> <span class="token string">'errors-only'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>webpack.dev.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> merge <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-merge'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> baseConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.base'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> devConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token punctuation">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>HotModuleReplacementPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  devServer<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    contentBase<span class="token punctuation">:</span> <span class="token string">'./dist'</span><span class="token punctuation">,</span>
    hot<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    stats<span class="token punctuation">:</span> <span class="token string">'errors-only'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  devtool<span class="token punctuation">:</span> <span class="token string">'cheap-source-map'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>baseConfig<span class="token punctuation">,</span> devConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>webpack.prod.js</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">const</span> cssnano <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cssnano'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> merge <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-merge'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> HtmlWebpackExternalsPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-externals-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> OptimizeCSSAssetsPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'optimize-css-assets-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> baseConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.base'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> prodConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token punctuation">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">OptimizeCSSAssetsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      assetNameRegExp<span class="token punctuation">:</span> <span class="token regex">/\.css$/g</span><span class="token punctuation">,</span>
      cssProcessor<span class="token punctuation">:</span> cssnano<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackExternalsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      externals<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          module<span class="token punctuation">:</span> <span class="token string">'react'</span><span class="token punctuation">,</span>
          entry<span class="token punctuation">:</span> <span class="token string">'https://11.url.cn/now/lib/16.2.0/react.min.js'</span><span class="token punctuation">,</span>
          global<span class="token punctuation">:</span> <span class="token string">'React'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          module<span class="token punctuation">:</span> <span class="token string">'react-dom'</span><span class="token punctuation">,</span>
          entry<span class="token punctuation">:</span> <span class="token string">'https://11.url.cn/now/lib/16.2.0/react-dom.min.js'</span><span class="token punctuation">,</span>
          global<span class="token punctuation">:</span> <span class="token string">'ReactDOM'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  optimization<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    splitChunks<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      minSize<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      cacheGroups<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        commons<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          name<span class="token punctuation">:</span> <span class="token string">'commons'</span><span class="token punctuation">,</span>
          chunks<span class="token punctuation">:</span> <span class="token string">'all'</span><span class="token punctuation">,</span>
          minChunks<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>baseConfig<span class="token punctuation">,</span> prodConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>webpack.ssr.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> cssnano <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cssnano'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> merge <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-merge'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> HtmlWebpackExternalsPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-externals-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> OptimizeCSSAssetsPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'optimize-css-assets-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> baseConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.base'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> prodConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token punctuation">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token string">'ignore-loader'</span><span class="token punctuation">,</span> <span class="token comment">// ignore css</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.less$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token string">'ignore-loader'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">OptimizeCSSAssetsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      assetNameRegExp<span class="token punctuation">:</span> <span class="token regex">/\.css$/g</span><span class="token punctuation">,</span>
      cssProcessor<span class="token punctuation">:</span> cssnano<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackExternalsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      externals<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          module<span class="token punctuation">:</span> <span class="token string">'react'</span><span class="token punctuation">,</span>
          entry<span class="token punctuation">:</span> <span class="token string">'https://11.url.cn/now/lib/16.2.0/react.min.js'</span><span class="token punctuation">,</span>
          global<span class="token punctuation">:</span> <span class="token string">'React'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          module<span class="token punctuation">:</span> <span class="token string">'react-dom'</span><span class="token punctuation">,</span>
          entry<span class="token punctuation">:</span> <span class="token string">'https://11.url.cn/now/lib/16.2.0/react-dom.min.js'</span><span class="token punctuation">,</span>
          global<span class="token punctuation">:</span> <span class="token string">'ReactDOM'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  optimization<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    splitChunks<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      minSize<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      cacheGroups<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        commons<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          name<span class="token punctuation">:</span> <span class="token string">'commons'</span><span class="token punctuation">,</span>
          chunks<span class="token punctuation">:</span> <span class="token string">'all'</span><span class="token punctuation">,</span>
          minChunks<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>baseConfig<span class="token punctuation">,</span> prodConfig<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="eslintè§„èŒƒè„šæœ¬"><a href="#eslintè§„èŒƒè„šæœ¬" aria-hidden="true" class="header-anchor">#</a> ESLintè§„èŒƒè„šæœ¬</h3> <p>.eslintrc.js</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;parser&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;babel-eslint&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;extends&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;airbnb-base&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;env&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;browser&quot;</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token string">&quot;node&quot;</span><span class="token punctuation">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="å†’çƒŸæµ‹è¯•"><a href="#å†’çƒŸæµ‹è¯•" aria-hidden="true" class="header-anchor">#</a> å†’çƒŸæµ‹è¯•</h3> <p>æäº¤æµ‹è¯•çš„è½¯ä»¶åœ¨è¿›è¡Œè¯¦ç»†æ·±å…¥çš„æµ‹è¯•ä¹‹å‰è¿›è¡Œçš„é¢„æµ‹è¯•ï¼Œè¿™ç§æµ‹è¯•çš„ä¸»è¦ç›®çš„æ˜¯æš´éœ²å¯¼è‡´è½¯ä»¶éœ€é‡æ–°å‘å¸ƒçš„åŸºæœ¬åŠŸèƒ½å¤±æ•ˆç­‰ä¸¥é‡é—®é¢˜</p> <h4 id="æ„å»ºæ˜¯å¦æˆåŠŸ"><a href="#æ„å»ºæ˜¯å¦æˆåŠŸ" aria-hidden="true" class="header-anchor">#</a> æ„å»ºæ˜¯å¦æˆåŠŸ</h4> <p>æŒ‡æ ‡ï¼š</p> <ol><li>æ˜¯å¦æœ‰js css ç­‰é™æ€æ–‡ä»¶</li> <li>æ˜¯å¦æœ‰htmlæ–‡ä»¶</li></ol> <p>æ–¹æ³•ï¼š</p> <ol><li>çœ‹æ„å»ºæ˜¯å¦æŠ¥é”™</li> <li>ç¼–å†™å•å…ƒæµ‹è¯•ç”¨ä¾‹, çœ‹æ˜¯å¦æœ‰css,js, æ˜¯å¦æœ‰html</li></ol> <h4 id="æµ‹è¯•æ–‡ä»¶ç¼–å†™"><a href="#æµ‹è¯•æ–‡ä»¶ç¼–å†™" aria-hidden="true" class="header-anchor">#</a> æµ‹è¯•æ–‡ä»¶ç¼–å†™</h4> <p>æ–°å»º test/smoke ç›®å½•<br>
index.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> rimraf <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'rimraf'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Mocha <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mocha'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> mocha <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Mocha</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    timeout<span class="token punctuation">:</span> <span class="token string">'10000ms'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

process<span class="token punctuation">.</span><span class="token function">chdir</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'template'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">rimraf</span><span class="token punctuation">(</span><span class="token string">'./dist'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> prodConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../../lib/webpack.prod.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">webpack</span><span class="token punctuation">(</span>prodConfig<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> stats</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
            process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stats<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            colors<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            modules<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            children<span class="token punctuation">:</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Webpack build success, begin run test.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        mocha<span class="token punctuation">.</span><span class="token function">addFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'html-test.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mocha<span class="token punctuation">.</span><span class="token function">addFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'css-js-test.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mocha<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>css js å•æµ‹æ–‡ä»¶ css-js-test.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> glob <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'glob-all'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'Checking generated css js files'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should generate css js files'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> files <span class="token operator">=</span> glob<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
            <span class="token string">'./dist/index_*.js'</span><span class="token punctuation">,</span>
            <span class="token string">'./dist/index_*.css'</span><span class="token punctuation">,</span>
            <span class="token string">'./dist/search_*.js'</span><span class="token punctuation">,</span>
            <span class="token string">'./dist/search_*.css'</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>files<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'no css js files generated'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>html å•æµ‹æ–‡ä»¶ html-test.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> glob <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'glob-all'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'Checking generated html files'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should generate html files'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> files <span class="token operator">=</span> glob<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
            <span class="token string">'./dist/index.html'</span><span class="token punctuation">,</span>
            <span class="token string">'./dist/search.html'</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>files<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'no html files generated'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>åŒæ—¶æµ‹è¯•ç›®å½•å¤–çš„webpack.base.jséœ€è¦æŠŠæ”¹å˜è·¯å¾„å†™æ³•</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> projectRoot <span class="token operator">=</span> process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> entryFiles <span class="token operator">=</span> glob<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>projectRoot<span class="token punctuation">,</span> <span class="token string">'./src/*/index.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// new HtmlWebpackPlugin</span>
template<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>projectRoot<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./src/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pageName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/index.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token operator">/</span><span class="token operator">/</span> module<span class="token punctuation">.</span>exports
output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>projectRoot<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    filename<span class="token punctuation">:</span> <span class="token string">'[name]_[chunkhash:8].js'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

</code></pre></div><h3 id="å•å…ƒæµ‹è¯•ä¸æµ‹è¯•è¦†ç›–ç‡"><a href="#å•å…ƒæµ‹è¯•ä¸æµ‹è¯•è¦†ç›–ç‡" aria-hidden="true" class="header-anchor">#</a> å•å…ƒæµ‹è¯•ä¸æµ‹è¯•è¦†ç›–ç‡</h3> <p>test ç›®å½•ä¸‹ æ–°å»º unit
test/index.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// è¿›å…¥smoke/template</span>
process<span class="token punctuation">.</span><span class="token function">chdir</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'smoke/template'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'builder-webpack test case'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./unit/webpack-base-test'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>unit/webpack-base-test</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> assert <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'assert'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'webpack.base.js test case'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> baseConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../../lib/webpack.base.js'</span><span class="token punctuation">)</span>

    <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'entry'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        assert<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span>baseConfig<span class="token punctuation">.</span>entry<span class="token punctuation">.</span>index<span class="token punctuation">,</span> <span class="token string">'/Users/cpselvis/my-project/builder-webpack/test/smoke/template/src/index/index.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        assert<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span>baseConfig<span class="token punctuation">.</span>entry<span class="token punctuation">.</span>search<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'builder-webpack/test/smoke/template/src/search/index.js'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ä¸ºäº†æŒç»­é›†æˆé…åˆçº¿ä¸Šè·¯å¾„</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>æµ‹è¯•è¦†ç›–ç‡ istanbul<br>
package.json</p> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token string">&quot;test&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;istanbul cover ./node_modules/.bin/_mocha&quot;</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="æŒç»­é›†æˆ"><a href="#æŒç»­é›†æˆ" aria-hidden="true" class="header-anchor">#</a> æŒç»­é›†æˆ</h3> <h4 id="æŒç»­é›†æˆä¼˜ç‚¹"><a href="#æŒç»­é›†æˆä¼˜ç‚¹" aria-hidden="true" class="header-anchor">#</a> æŒç»­é›†æˆä¼˜ç‚¹</h4> <ul><li>å¿«é€Ÿå‘ç°é”™è¯¯</li> <li>é˜²æ­¢åˆ†æ”¯å¤§å¹…åç¦»ä¸»å¹²
æ ¸å¿ƒæªæ–½æ˜¯ï¼Œä»£ç é›†æˆåˆ°ä¸»å¹²å‰ï¼Œå¿…é¡»é€šè¿‡è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œåªè¦æœ‰ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹å¤±è´¥ï¼Œå°±ä¸èƒ½é›†æˆã€‚</li></ul> <h4 id="æ¥å…¥-travis-ci"><a href="#æ¥å…¥-travis-ci" aria-hidden="true" class="header-anchor">#</a> æ¥å…¥ Travis CI</h4> <ol><li>https://travis-ci.org/ ä½¿ç”¨ GitHub è´¦å·ç™»å½•</li> <li>åœ¨ https://travis-ci.org/account/repositories ä¸ºé¡¹ç›®å¼€å¯</li> <li>é¡¹ç›®æ ¹ç›®å½•ä¸‹æ–°å¢ .travis.yml</li></ol> <h4 id="travis-ymlæ–‡ä»¶å†…å®¹"><a href="#travis-ymlæ–‡ä»¶å†…å®¹" aria-hidden="true" class="header-anchor">#</a> .travis.ymlæ–‡ä»¶å†…å®¹</h4> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">language</span><span class="token punctuation">:</span> node_js
<span class="token key atrule">sudo</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
<span class="token key atrule">cache</span><span class="token punctuation">:</span>
  <span class="token key atrule">apt</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">directories</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> node_modules
<span class="token key atrule">node_js</span><span class="token punctuation">:</span> stable
<span class="token key atrule">install</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> npm install <span class="token punctuation">-</span>D
  <span class="token punctuation">-</span> cd ./test/smoke/template
  <span class="token punctuation">-</span> npm install <span class="token punctuation">-</span>D
  <span class="token punctuation">-</span> cd ../../../
<span class="token key atrule">scripts</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span>npm test
</code></pre></div><p>å‡çº§è¡¥ä¸ç‰ˆæœ¬å·ï¼šnpm version patch<br>
å‡çº§å°ç‰ˆæœ¬å·ï¼šnpm version minor<br>
å‡çº§å¤§ç‰ˆæœ¬å·ï¼šnpm version major<br>
å°†è‡ªåŠ¨æ›´æ”¹ç‰ˆæœ¬å·ï¼Œå¹¶æäº¤git</p> <h3 id="gitè§„èŒƒå’Œchangelogç”Ÿæˆ"><a href="#gitè§„èŒƒå’Œchangelogç”Ÿæˆ" aria-hidden="true" class="header-anchor">#</a> gitè§„èŒƒå’ŒchangeLogç”Ÿæˆ</h3> <p>è‰¯å¥½çš„ Git commit è§„èŒƒä¼˜åŠ¿ï¼š<br></p> <ul><li>åŠ å¿« Code Review çš„æµç¨‹</li> <li>æ ¹æ® Git Commit çš„å…ƒæ•°æ®ç”Ÿæˆ Changelog</li> <li>åç»­ç»´æŠ¤è€…å¯ä»¥çŸ¥é“ Feature è¢«ä¿®æ”¹çš„åŸå› 
<img src="/assets/img/webpack-git.e955a34a.png" alt="git"></li></ul> <h4 id="angularè§„èŒƒ"><a href="#angularè§„èŒƒ" aria-hidden="true" class="header-anchor">#</a> angularè§„èŒƒ</h4> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>type</span><span class="token punctuation">&gt;</span></span>(<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>): <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>subject</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>BLANK</span> <span class="token attr-name">LINE</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>BLANK</span> <span class="token attr-name">LINE</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>footer</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>æ ‡é¢˜è¡Œ: å¿…å¡«, æè¿°ä¸»è¦ä¿®æ”¹ç±»å‹å’Œå†…å®¹</li> <li>ä¸»é¢˜å†…å®¹: æè¿°ä¸ºä»€ä¹ˆä¿®æ”¹, åšäº†ä»€ä¹ˆæ ·çš„ä¿®æ”¹, ä»¥åŠå¼€å‘çš„æ€è·¯ç­‰ç­‰</li> <li>é¡µè„šæ³¨é‡Š: æ”¾ Breaking Changes æˆ– Closed Issues</li></ul> <h4 id="è¯¦è§£"><a href="#è¯¦è§£" aria-hidden="true" class="header-anchor">#</a> è¯¦è§£</h4> <ul><li>type: commit çš„ç±»å‹</li> <li>feat: æ–°ç‰¹æ€§</li> <li>fix: ä¿®æ”¹é—®é¢˜</li> <li>refactor: ä»£ç é‡æ„</li> <li>docs: æ–‡æ¡£ä¿®æ”¹</li> <li>style: ä»£ç æ ¼å¼ä¿®æ”¹, æ³¨æ„ä¸æ˜¯ css ä¿®æ”¹</li> <li>test: æµ‹è¯•ç”¨ä¾‹ä¿®æ”¹</li> <li>chore: å…¶ä»–ä¿®æ”¹, æ¯”å¦‚æ„å»ºæµç¨‹, ä¾èµ–ç®¡ç†.</li> <li>scope: commit å½±å“çš„èŒƒå›´, æ¯”å¦‚: route, component, utils, build...</li> <li>subject: commit çš„æ¦‚è¿°, å»ºè®®ç¬¦åˆ  50/72 formatting</li> <li>body: commit å…·ä½“ä¿®æ”¹å†…å®¹, å¯ä»¥åˆ†ä¸ºå¤šè¡Œ, å»ºè®®ç¬¦åˆ 50/72 formatting</li> <li>footer: ä¸€äº›å¤‡æ³¨, é€šå¸¸æ˜¯ BREAKING CHANGE æˆ–ä¿®å¤çš„ bug çš„é“¾æ¥.</li></ul> <p>æœ¬åœ°å¼€å‘é˜¶æ®µå¢åŠ precommité’©å­</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> husky -D
</code></pre></div><p>package.json</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;script&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;commitmsg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;validate-commit-msg&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;changelog&quot;</span><span class="token operator">:</span> &quot;conventional-changelog -p
angular -i CHANGELOG.md -s -r <span class="token number">0</span>&quot;
<span class="token punctuation">}</span>
</code></pre></div><p>validate-commit-msg å¥½åƒåºŸå¼ƒäº†ï¼Œæ¨èä½¿ç”¨commitlint <br>
husky 0.12ç‰ˆæœ¬åï¼Œé…ç½®å·²æ”¹ä¸ºï¼š<br>
commit-msg<br>
pre-commit<br>
è¦åŠ ï¼ˆ-ï¼‰æ¨ªæ äº†</p> <h2 id="ä¼˜åŒ–"><a href="#ä¼˜åŒ–" aria-hidden="true" class="header-anchor">#</a> ä¼˜åŒ–</h2> <h2 id="æºç "><a href="#æºç " aria-hidden="true" class="header-anchor">#</a> æºç </h2> <h2 id="ç¼–å†™loaderå’Œplugin"><a href="#ç¼–å†™loaderå’Œplugin" aria-hidden="true" class="header-anchor">#</a> ç¼–å†™loaderå’Œplugin</h2> <h2 id="å®æˆ˜-react"><a href="#å®æˆ˜-react" aria-hidden="true" class="header-anchor">#</a> å®æˆ˜ React</h2></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w2-åŠ¨æ‰‹æ­å»ºä¸ªvueé¡¹ç›®.html" class="prev">
          w2-åŠ¨æ‰‹æ­å»ºä¸ªvueé¡¹ç›®
        </a></span> <span class="next"><a href="/å‰ç«¯å¼€å‘/è¿›é˜¶/w4-è‡ªå·±å®ç°ä¸ªwebpack.html">
          w4-è‡ªå·±å®ç°ä¸ªwebpack
        </a>
        â†’
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.20b7a3cd.js" defer></script><script src="/assets/js/2.94e36c74.js" defer></script><script src="/assets/js/3.ff294584.js" defer></script>
  </body>
</html>
